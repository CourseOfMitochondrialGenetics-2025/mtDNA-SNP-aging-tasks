# Практический анализ вариантов мтДНК: руководство по настройке

## 1. Установите R и RStudio (IDE)

-   Загрузите [R](https://cran.r-project.org/)
-   Загрузите [RStudio](https://posit.co/download/rstudio-desktop/) (достаточно версии для настольных компьютеров)

## 2. Необходимые библиотеки R

Запустите в R:

`install.packages(c(„BiocManager“, „rmarkdown“, „Rsubread“, „QuasR“, „ggplot2“, „data.table“, „aws.s3“))` `BiocManager::install(„GenomicAlignments“)`

## 3. Внешние инструменты

-   Загрузите и установите [GATK 4.x+](https://gatk.broadinstitute.org/)
-   [Mutect2](https://gatk.broadinstitute.org/) является частью GATK (требуется Java 8+)
-   Загрузите FASTA референсного генома человека (GRCh38): через [набор ресурсов GATK](https://gatk.broadinstitute.org/hc/en-us/articles/360035890811) или NCBI

## 4. Подготовка данных

-   Загрузите файлы FASTQ человека
-   Загрузите референсный геном [GRCh38.p14] (https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/405/GCA_000001405.29_GRCh38.p14/GCA_000001405.29_GRCh38.p14_genomic.fna.gz)

## 5. Обзор рабочего процесса

-   Получение данных: загрузка исходных файлов FASTQ человека и справочных файлов.
-   Установка инструментов: настройка R, RStudio и необходимых пакетов R/Bioconductor.
-   Выравнивание чтений: сопоставление FASTQ со справочным геномом с помощью Rsubread или QuasR.
-   Контроль качества и отчетность: визуализация и обобщение покрытия, проверка статистики сопоставления.
-   Коллинг вариантов и последующие действия: набросок или запуск Mutect2 (или использование готового конвейера MitoHPC).
-   Интерпретация результатов: изучение обнаруженных вариантов, гетероплазмии и биологического значения.

## 6. Как запустить предоставленный блокнот R Markdown

-   Откройте файл `alignment_and_variant_calling.Rmd` в RStudio.
-   Прочитайте «Введение», чтобы ознакомиться с биологической информацией и логикой шагов.
-   Запустите каждый фрагмент кода по порядку (Ctrl+Shift+Enter) и следуйте выводу и комментариям.
-   Графики и таблицы появятся в IDE; результаты можно сохранить или преобразовать в HTML.
-   Для коллинга вариантов может потребоваться запуск системной команды (см. инструкции, например, Mutect2), если файлы BAM слишком велики для обработки в R. 
Результаты можно загрузить обратно в R для обобщения и визуализации.
