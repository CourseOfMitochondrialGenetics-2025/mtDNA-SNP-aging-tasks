# Введение в анализ митохондриальной ДНК: практикум по биоинформатике

## Обзор проекта

Этот проект научит вас анализировать варианты человеческой митохондриальной ДНК (мтДНК) из необработанных данных полногеномного секвенирования (NGS) в формате FASTQ. Вы загрузите открытые данные NGS человека, выровняете риды на эталонный геном человека и изучите процедуры для обнаружения вариантов, используя современные инструменты, удобные для студентов, и записные книжки R Markdown.

### Цель обучения

По завершении этого практикума вы сможете:
- **Получать и подготавливать** необработанные данные NGS для анализа мтДНК
- **Выполнять** эффективное выравнивание рассеивающих данных на эталонный геном
- **Вызывать** варианты мтДНК с использованием современных инструментов биоинформатики
- **Фильтровать** артефакты и ложноположительные варианты (NUMT-контаминация)
- **Интерпретировать** результаты и визуализировать окончательные варианты

---

## Биологический и технический контекст

### Почему анализировать мтДНК?

**Материнское наследование и множественные копии:**
- Митохондриальная ДНК наследуется исключительно материнской линией (в большинстве случаев)
- Каждая клетка содержит сотни-тысячи копий мтДНК (в отличие от двух копий ядерной ДНК)
- Это позволяет обнаруживать варианты при очень низкой гетероплазмии (< 0.5%)

**Накопление мутаций:**
- мтДНК накапливает варианты со временем, связанные со старением и заболеваниями
- Высокая скорость мутаций в некоторых регионах позволяет использовать мтДНК для популяционных исследований

**Клиническое значение:**
- Варианты мтДНК связаны с неврологическими, сердечными и метаболическими заболеваниями
- Гетероплазмия (наличие нескольких вариантов мтДНК в одной клетке) может влиять на экспрессию фенотипа

**Популяционная генетика и эволюция:**
- мтДНК используется для изучения миграции человека и филогенетических связей
- Гаплогруппы мтДНК определяются характерными наборами вариантов

### Требования к анализу

Полный анализ вариантов мтДНК требует:

1. **Доступ к необработанным данным** — загрузка открытых данных NGS из проектов, как 1000 Genomes
2. **Надежное выравнивание** — отображение рассеивающих данных на эталонный геном с высокой точностью
3. **Обнаружение вариантов** — идентификация позиций, где риды отличаются от эталона
4. **Интерпретация результатов** — различие истинных вариантов мтДНК от артефактов, NUMT-контаминации, ошибок секвенирования

---

## Ключевые научные статьи и ресурсы

### Основные публикации

**Статья 1 — Инструменты биоинформатики:**
- Barresi M. et al. (2025). "Bioinformatics Tools for NGS-Based Identification of Single Nucleotide Variants and Large-Scale Rearrangements in Mitochondrial DNA." *BioTech*, PMC11843820.
- Описывает инструменты MitoSAlt и Mitopore для обнаружения вариантов мтДНК из данных NGS
- Охватывает как SNV/MNP, так и крупномасштабные перестановки

**Статья 2 — Современные конвейеры:**
- Battle SL et al. (2022). "A bioinformatics pipeline for estimating mitochondrial DNA copy number and heteroplasmy levels from whole genome sequencing data." *NAR Genomics and Bioinformatics*, 4(2):lqac034.
- Представляет MitoHPC и вспомогательные инструменты для комплексного анализа мтДНК
- Включает стратегии фильтрации NUMT и количественной оценки гетероплазмии

---

## Почему выбрать упрощенные и современные инструменты?

### Проблемы с устаревшими подходами

Традиционные инструменты биоинформатики часто требуют:
- Сложных сценариев установки и управления зависимостями
- Обширных знаний командной строки Linux/Unix
- Разнородных рабочих процессов (несколько инструментов, слабо интегрированных)
- Специалистов по IT для управления вычислительной инфраструктурой

### Преимущества современного подхода

**R и Bioconductor:**
- **Кроссплатформенность:** одинаково работает на Windows, macOS и Linux
- **Интеграция:** все инструменты в едином языке программирования
- **Воспроизводимость:** R Markdown объединяет код, результаты и нарицательный текст
- **Активное сообщество:** постоянные обновления и поддержка

**Специализированные конвейеры:**
- **Оптимизация для мтДНК:** параметры, настроенные специально для высокого покрытия и низкочастотных вариантов
- **Встроенная фильтрация NUMT:** автоматическое выявление и удаление артефактов
- **Полная функциональность:** выравнивание → вызов вариантов → аннотация → отчет в одном конвейере

### Рекомендуемые инструменты

| Задача анализа | Традиционный инструмент | Современная альтернатива | Преимущества |
|---|---|---|---|
| Выравнивание рассеивания | BWA/Minimap2 (CLI) | Rsubread (R пакет) | Кроссплатформенность, интеграция с R |
| Вызов вариантов | Mitopore (веб/Docker) | GATK Mutect2 / MitoHPC | Хорошо документировано, открытый исходный код, надежно |
| Визуализация | IGV + пользовательские скрипты | R/Bioconductor + R Markdown | Все в одном месте, полностью воспроизводимо |
| Отчетность | Несколько файлов, ручная сборка | R Markdown / MitoHPC | Автоматическое создание отчета с кодом и результатами |

**Ключевые ссылки на инструменты:**
- [MitoHPC GitHub](https://github.com/ArkingLab/MitoHPC) — комплексный конвейер анализа мтДНК
- [Rsubread Bioconductor](https://bioconductor.org/packages/release/bioc/html/Rsubread.html) — выравнивание внутри R
- [QuasR Bioconductor](https://bioconductor.org/packages/release/bioc/html/QuasR.html) — альтернативный конвейер выравнивания в R

---

## Открытые источники данных мтДНК человека

### 1000 Genomes Project (рекомендуется для обучения)

**Что это:**
- Крупнейший проект секвенирования, охватывающий > 2,500 образцов из 26 популяций
- Данные открытого доступа, свободно доступны для исследований
- Высокое качество и хорошо задокументированы

**Как получить доступ:**

Через AWS Public Data Registry:
```bash
# Реестр: https://registry.opendata.aws/1000-genomes/

# Пример загрузки с использованием AWS CLI:
aws s3 cp --no-sign-request \
  s3://1000genomes/phase3/data/HG00101/sequence_read/SRR062634.filt.fastq.gz \
  ./

# Или используя wget:
wget https://ftp.sra.ebi.ac.uk/vol1/fastq/SRR062/SRR062634/SRR062634.fastq.gz
```

**Типичные размеры файлов:**
- Один файл FASTQ обычно 500 MB – 2 GB (в зависимости от покрытия)
- Требуемое время загрузки: 10–30 минут при скорости 10 Мбит/с

### NCBI Sequence Read Archive (SRA)

**Что это:**
- Огромный репозиторий последовательностей NGS со всего мира
- Содержит данные для человека, растений, микробов и т.д.
- Часто имеет более редкие образцы, чем 1000 Genomes

**Как получить доступ:**
```bash
# Поиск: https://www.ncbi.nlm.nih.gov/sra

# Загрузка с помощью SRA Toolkit:
# Установка: https://github.com/ncbi/sra-tools/wiki/01.-Downloading-SRA-Toolkit

fastq-dump --gzip SRR062634  # преобразует SRA в FASTQ
```

**Примеры для обучения:**
- [GSM3167371](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3167371) — полногеномное секвенирование человека
- Найдите исследования по ключевым словам: "mitochondrial DNA", "mtDNA sequencing"

---

## Подготовка к работе: что вам понадобится

### Программное обеспечение

**R и RStudio:**
- Загрузите [R](https://cran.r-project.org/) для вашей ОС (Windows/macOS/Linux)
- Загрузите [RStudio Desktop](https://posit.co/download/rstudio-desktop/) (свободная версия достаточна)
- Убедитесь в совместимости версий

**R пакеты (установка внутри R):**
```r
# Установка стандартных пакетов
install.packages(c('BiocManager', 'rmarkdown', 'ggplot2', 'data.table', 'dplyr'))

# Установка биоинформатических пакетов через Bioconductor
BiocManager::install(c('Rsubread', 'GenomicAlignments', 
                       'VariantAnnotation', 'Rsamtools'))
```

**Внешние инструменты (опционально):**
- [GATK 4.x+](https://gatk.broadinstitute.org/) — для продвинутого вызова вариантов (требует Java 8+)
- [Minimap2](https://github.com/lh3/minimap2) — альтернативный выравниватель

**Данные:**
- Эталонный геном человека (GRCh38 FASTA) — загрузите из [GATK resource bundle](https://gatk.broadinstitute.org/hc/en-us/articles/360035890811) или [NCBI](https://www.ncbi.nlm.nih.gov/grc)
- Примеры FASTQ файлов — из 1000 Genomes (ссылки выше)

### Требуемые ресурсы

| Ресурс | Минимум | Рекомендуется |
|---|---|---|
| Оперативная память (RAM) | 4 GB | 8–16 GB |
| Дисковое пространство | 50 GB | 200+ GB |
| Процессор | 2 ядра | 4–8 ядер |
| Время обработки (1 образец) | 30 минут | 10–15 минут |

---

## Структура практикума

Этот практикум состоит из нескольких скоординированных компонентов:

### 1. **README.md** — Полное руководство по установке и подготовке
   - Пошаговые инструкции по установке R, RStudio и библиотек
   - Ссылки для загрузки данных и эталонных геномов
   - Проверка установки и устранение неполадок

### 2. **alignment_and_variant_calling.Rmd** (Файл 1) — Выравнивание и подготовка
   - Загрузка необработанных FASTQ файлов
   - Выравнивание на эталонный геном с помощью Rsubread
   - Контроль качества выравнивания (MAPQ, глубина покрытия, статистика)
   - Пакетная обработка множественных образцов
   - Подготовка к вызову вариантов

### 3. **variant_calling_numt_filtering.Rmd** (Файл 2) — Вызов вариантов и фильтрация NUMT
   - Вызов вариантов SNP/MNP с использованием GATK Mutect2 или MitoHPC
   - Фильтрация на основе качества рассеивания (QUAL, глубина, MAPQ)
   - Сравнение с популяционными базами данных (gnomAD, MITOMAP, HmtDB)
   - Обнаружение и удаление артефактов NUMT (Nuclear Mitochondrial DNA)
   - Классификация гаплогрупп
   - Интерпретация и валидация вариантов

### 4. **bibliography.md** — Полная библиография
   - 39 научных источников, отформатированных по ГОСТ
   - Доступ ко всем ключевым статьям и базам данных
   - Популярные источники по мтДНК анализу

---

## Учебный процесс: как работать с этим практикумом

### Фаза 1: Подготовка (1–2 часа)
1. Прочитайте этот документ (введение) для получения контекста
2. Следуйте инструкциям README.md для установки всех необходимых инструментов
3. Проверьте установку, загрузив библиотеки R в RStudio

### Фаза 2: Выравнивание (2–4 часа)
1. Откройте `alignment_and_variant_calling.Rmd` в RStudio
2. Следуйте инструкциям для загрузки и подготовки FASTQ данных
3. Запустите каждый код блок по порядку
4. Интерпретируйте статистику выравнивания и графики

### Фаза 3: Вызов вариантов и фильтрация (3–6 часов)
1. Откройте `variant_calling_numt_filtering.Rmd`
2. Используйте BAM файлы из Фазы 2 как входные данные
3. Запустите внешний вариант вызывающий инструмент (GATK Mutect2 или MitoHPC) в командной строке
4. Загрузите VCF результаты в R
5. Примените многоуровневую фильтрацию для удаления артефактов NUMT

### Фаза 4: Интерпретация и отчетность (1–2 часа)
1. Создайте окончательный список высокоуверенных вариантов
2. Визуализируйте варианты мтДНК вдоль генома
3. Создайте HTML отчет для презентации результатов

---

## Ключевые концепции, которые вы изучите

### Биоинформатика NGS
- **Формат FASTQ:** представление необработанных рассеиваний (ID, последовательность, качество)
- **Выравнивание:** отображение рассеиваний на эталонный геном
- **Формат BAM:** сжатое представление выровненных данных
- **Вызов вариантов:** идентификация позиций, отличающихся от эталона

### Специфичное для мтДНК
- **Гетероплазмия:** наличие нескольких вариантов мтДНК в одной клетке
- **NUMT (Nuclear Mitochondrial DNA):** последовательности мтДНК, вставленные в ядерный геном — частый источник ложноположительных вариантов
- **Гаплогруппы:** наборы вариантов мтДНК, определяющие материнское происхождение
- **Качество выравнивания:** MAPQ, глубина покрытия, смещение цепи — показатели надежности варианта

### Практические навыки
- Работа с биоинформатическими инструментами в R
- Анализ и визуализация больших наборов данных
- Фильтрация и интерпретация биологических результатов
- Создание воспроизводимых рабочих процессов в R Markdown

---

## Типичный рабочий процесс (обзор)

```
Необработанные FASTQ файлы (1000 Genomes)
         ↓
    Выравнивание (Rsubread)
         ↓
    BAM файлы (выровненные риды)
         ↓
    Контроль качества выравнивания
         ↓
    Вызов вариантов (GATK Mutect2 / MitoHPC)
         ↓
    VCF файлы (исходные варианты)
         ↓
    Фильтрация качества
         ↓
    Фильтрация NUMT (базы данных, свойства рассеивания)
         ↓
    Проверка гаплогруппы и консистентности
         ↓
    Высокоуверенные варианты мтДНК
         ↓
    Визуализация и интерпретация
         ↓
    Финальный отчет
```

---

## Часто задаваемые вопросы (FAQ)

**В: Нужны ли мне знания Linux командной строки?**
Ответ: Нет. Все основные анализы проводятся в R/RStudio. Некоторые внешние инструменты (GATK) могут использовать командную строку, но инструкции предоставлены.

**В: Как долго занимает анализ одного образца?**
Ответ: Выравнивание 1–2 часа (в зависимости от размера файла и процессора), вызов вариантов 15–30 минут, фильтрация вариантов 10–15 минут.

**В: Могу ли я использовать собственные FASTQ файлы вместо 1000 Genomes?**
Ответ: Да, абсолютно. Рабочий процесс одинаков для любых FASTQ файлов. Убедитесь, что у вас есть соответствующий эталонный геном.

**В: Что такое NUMT и почему это проблема?**
Ответ: NUMT — это фрагменты мтДНК, вставленные в ядерный геном во время эволюции. Когда риды выравниваются на мтДНК, некоторые NUMT-производные риды также выравниваются, вызывая ложноположительные варианты. Фильтрация NUMT критична для точности.

**В: Как я узнаю, являются ли мои варианты достоверными?**
Ответ: Используйте многоуровневую фильтрацию: (1) качество рассеивания (QUAL, MAPQ), (2) сравнение с популяционными базами данных (gnomAD), (3) консистентность гаплогруппы, (4) ручная визуализация в IGV.

---

## Заключение и следующие шаги

Этот практикум предоставляет полный, исходный, воспроизводимый рабочий процесс для анализа вариантов мтДНК человека. После завершения вы:

✅ Поймете, как работают инструменты NGS биоинформатики  
✅ Сможете загружать и обрабатывать открытые данные человека  
✅ Создадите список высокоуверенных вариантов мтДНК  
✅ Сможете избежать распространенных артефактов (NUMT, артефакты секвенирования)  
✅ Научитесь документировать и представлять результаты  

**Для расширенного обучения рассмотрите:**
- Гаплогруппное назначение и филогенетический анализ
- Популяционные исследования гетероплазмии
- Функциональная аннотация вариантов (кодирующие vs некодирующие)
- Исследование связи между вариантами мтДНК и болезнями

---

## Дополнительные ресурсы

- [NCBI mtDNA Genbank](https://www.ncbi.nlm.nih.gov/genomes/OrganelleResource.cgi?taxid=9606&k=NC_012920)
- [PhyloTree mtDNA Haplogroups](http://www.phylotree.org/)
- [MITOMAP Mutations Database](https://www.mitomap.org/)
- [gnomAD Browser](https://gnomad.broadinstitute.org/)
- [HmtDB Human Mitochondrial Database](https://www.hmtdb.unibo.it/)
